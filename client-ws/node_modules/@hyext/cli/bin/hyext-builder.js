#!/usr/bin/env node

const path = require('path')
const commander = require('commander')
const spawn = require('cross-spawn')
const packageJson = require('../package.json')
const readProjectConfig = require('../lib/readProjectConfig')

const projectCfg = readProjectConfig()
const program = new commander.Command(packageJson.name)

program.usage('builder <command> [options]')

program
  .command('view')
  .description('View builder info')
  .action(() => {
    spawn('npm', ['ls', projectCfg.builder.name, '-depth', '0'], { stdio: 'inherit' })
  })

program
  .command('update [version]')
  .description('Install the specified version of the builder (default: "latest")')
  .action((version = 'latest') => {
    spawn('npm', ['i', '-D', `${projectCfg.builder.name}@${version}`], { stdio: 'inherit' })
  })

program.parse(process.argv)
