const path = require('path')

module.exports = function parseBuilderParam(value) {
  let name = ''
  let folder = ''

  if (!value) return { name, folder };

  const isAbsolute = path.isAbsolute(value)
  const isPath = isAbsolute || value.slice(0, 2) == './' || value.slice(0, 2) == '..'

  if (isPath) {
    folder = isAbsolute ? path.resolve(value) : path.resolve(process.cwd(), value)
    name = require(path.join(folder, 'package.json')).name
  } else {
    const prefix = '@hyext/builder-'
    name = value.indexOf(prefix) != -1 ? value : (prefix + value)
  }

  return {
    name,
    folder
  }
}
