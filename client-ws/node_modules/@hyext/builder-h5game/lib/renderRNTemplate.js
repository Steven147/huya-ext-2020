const path = require('path')
const fs = require('fs-extra')

// FIXME 每个项目都单独渲染一个入口, 不然并行的时候有 bug
function renderRNTemplate({ templateDir, config }) {
  const srcPath = path.resolve(templateDir, 'src', 'Game_template.js')
  const destPath = path.resolve(templateDir, 'src', 'Game.js')
  const content = fs.readFileSync(srcPath, { encoding: 'utf8' }).toString()
  fs.writeFileSync(destPath, content.replace(/HYEXT_GAME_STRINGIFY_CONFIG_PLACEHOLDER/mg, JSON.stringify(config)), { encoding: 'utf8' })
}

module.exports = { renderRNTemplate }
